jQuery(document).ready(function(e){for(var s=e(".sign-up-module"),t=0;t<s.length;t++)e(s[t]).signup();"undefined"!=typeof _satellite&&_satellite.track(floodlightLoad)}),function(e){"use strict";e.fn.signup=function(){function s(){r(),e(p).attr("aria-hidden","false"),_.attr("aria-hidden","false"),_.click(t),c.unbind("keypress",a),c.bind("keypress",t),_.click(function(){n()})}function t(e){13==e.keyCode&&n()}function a(e){13==e.keyCode&&l()}function n(){r(),1==o(p.value)?(h.addClass("step2"),"undefined"!=typeof _satellite&&_satellite.track(floodlightStart),setTimeout(function(){g.addClass("show"),e(p).attr("aria-hidden","true"),_.attr("aria-hidden","true"),c.unbind("keypress",t),c.bind("keypress",a),v.click(function(){l()}),m.focus()},600)):(y.addClass("show"),e(p).attr("aria-describedby","sign-up-module__error-email"),p.focus())}function i(){s(),h.removeClass("step2"),g.removeClass("show"),setTimeout(function(){p.focus()},600)}function o(e){var s=/^([-\w]|[-\w][-.\w]*[-\w])@([-a-zA-Z0-9]+\.)+[-a-zA-Z0-9]{2,4}$/i;return s.test(e)}function u(e){var s=/^[a-zA-Z .'-]+$/;return e.length>0&&e.length<40&&s.test(e)}function r(){y.removeClass("show"),k.removeClass("show"),C.removeClass("show")}function d(){var e="https://digitalapi-pdev.npe.auspost.com.au/api/accessone/v1/marketing/subscription";return"ptest.npe.auspost.com.au"===location.hostname||"localhost"===location.hostname?e="https://digitalapi-ptest.npe.auspost.com.au/api/accessone/v1/marketing/subscription":"stest.npe.auspost.com.au"===location.hostname?e="https://digitalapi-stest.npe.auspost.com.au/api/accessone/v1/marketing/subscription":"auspost.com.au"===location.hostname&&(e="https://digitalapi.auspost.com.au/api/accessone/v1/marketing/subscription"),e}function l(){r(),u(m.value)&&u(f.value)?0==b&&(b=!0,v.addClass("sending"),g.removeClass("show"),setTimeout(function(){var s={individual:{first_name:m.value,last_name:f.value,email_address:p.value},market_opt_in_checked:!0,source:{campaign:"SBSub",channel:"Online"}};e.ajax({url:d(),type:"POST",crossDomain:!0,data:JSON.stringify(s),contentType:"application/json; charset=utf-8",dataType:"json",async:!1,success:function(e){h.removeClass("step2"),h.addClass("step3"),b=!1,v.removeClass("sending"),"undefined"!=typeof _satellite&&_satellite.track(floodlightComplete)},error:function(e,s,t){r(),b=!1,v.removeClass("sending"),C.addClass("show"),v.attr("aria-describedby","sign-up-module__error-server"),setTimeout(function(){r(),g.addClass("show")},5e3)}})},100)):(k.addClass("show"),e(m).attr("aria-describedby","sign-up-module__error-names"),e(m).focus())}var c=e(this),p=c.find(".sign-up-module__email")[0],m=c.find(".sign-up-module__first-name")[0],f=c.find(".sign-up-module__last-name")[0],_=c.find(".sign-up-module__next"),g=c.find(".sign-up-module__go-back"),h=c.find(".sign-up-module__steps"),v=c.find(".sign-up-module__submit"),k=c.find(".sign-up-module__error-names"),y=c.find(".sign-up-module__error-email"),C=c.find(".sign-up-module__error-server"),b=!1;g.click(function(){i()}),s()}}(jQuery);